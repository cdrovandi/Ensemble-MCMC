
%% ricker model

% EnKF - 250 particles
load('data_nutria.mat');
y = log(y);

N = 250;
theta_init = [0.0517263338534942	-1.82433230479132e-05	-2.48322859630890	-3.12811329515897	6.12474366061771];

iters = 100000;

cov_rw = [0.000676409167258427,-2.23338600978907e-07,0.000446523169356018,-0.00217383399843512,-0.00140842407121212;-2.23338600978907e-07,8.42843550109126e-11,-1.43589642115548e-07,3.22813798987884e-07,4.63121072766443e-07;0.000446523169356018,-1.43589642115548e-07,0.00710728108138167,-0.0231838048874914,-0.00173384121992989;-0.00217383399843512,3.22813798987884e-07,-0.0231838048874914,0.583962485086875,-0.00735450516306901;-0.00140842407121212,4.63121072766443e-07,-0.00173384121992989,-0.00735450516306901,0.0161676520940240];

[theta, loglikes] = pmcmc_EnKF_ricker(y,theta_init,iters,N,cov_rw);



% EnKF - 1000 particles
load('data_nutria.mat');
y = log(y);

N = 1000;
theta_init = [0.0517263338534942	-1.82433230479132e-05	-2.48322859630890	-3.12811329515897	6.12474366061771];

% reduce number of iterations for testing purposes
iters = 100000;

cov_rw = [0.000676409167258427,-2.23338600978907e-07,0.000446523169356018,-0.00217383399843512,-0.00140842407121212;-2.23338600978907e-07,8.42843550109126e-11,-1.43589642115548e-07,3.22813798987884e-07,4.63121072766443e-07;0.000446523169356018,-1.43589642115548e-07,0.00710728108138167,-0.0231838048874914,-0.00173384121992989;-0.00217383399843512,3.22813798987884e-07,-0.0231838048874914,0.583962485086875,-0.00735450516306901;-0.00140842407121212,4.63121072766443e-07,-0.00173384121992989,-0.00735450516306901,0.0161676520940240];

[theta, loglikes] = pmcmc_EnKF_ricker(y,theta_init,iters,N,cov_rw);




% EnKF - correlated
load('data_nutria.mat');
y = log(y);

N = 25;
theta_init = [0.0517263338534942	-1.82433230479132e-05	-2.48322859630890	-3.12811329515897	6.12474366061771];

% reduce number of iterations for testing purposes
iters = 100000;

cov_rw = [0.000676409167258427,-2.23338600978907e-07,0.000446523169356018,-0.00217383399843512,-0.00140842407121212;-2.23338600978907e-07,8.42843550109126e-11,-1.43589642115548e-07,3.22813798987884e-07,4.63121072766443e-07;0.000446523169356018,-1.43589642115548e-07,0.00710728108138167,-0.0231838048874914,-0.00173384121992989;-0.00217383399843512,3.22813798987884e-07,-0.0231838048874914,0.583962485086875,-0.00735450516306901;-0.00140842407121212,4.63121072766443e-07,-0.00173384121992989,-0.00735450516306901,0.0161676520940240];
sigma_corr = 0.1;

[theta, loglikes] = pmcmc_EnKF_ricker_correlated(y,theta_init,iters,N,cov_rw,sigma_corr);


% EnKF - correlated - unbiased
load('data_nutria.mat');
y = log(y);

N = 25;
theta_init = [0.0517263338534942	-1.82433230479132e-05	-2.48322859630890	-3.12811329515897	6.12474366061771];

% reduce number of iterations for testing purposes
iters = 100000;

cov_rw = [0.000676409167258427,-2.23338600978907e-07,0.000446523169356018,-0.00217383399843512,-0.00140842407121212;-2.23338600978907e-07,8.42843550109126e-11,-1.43589642115548e-07,3.22813798987884e-07,4.63121072766443e-07;0.000446523169356018,-1.43589642115548e-07,0.00710728108138167,-0.0231838048874914,-0.00173384121992989;-0.00217383399843512,3.22813798987884e-07,-0.0231838048874914,0.583962485086875,-0.00735450516306901;-0.00140842407121212,4.63121072766443e-07,-0.00173384121992989,-0.00735450516306901,0.0161676520940240];
sigma_corr = 0.1;

[theta, loglikes] = pmcmc_EnKF_ricker_correlated_unbiased(y,theta_init,iters,N,cov_rw,sigma_corr);



% EnKF - rqmc
load('data_nutria.mat');
y = log(y);

N = 50;
theta_init = [0.0517263338534942	-1.82433230479132e-05	-2.48322859630890	-3.12811329515897	6.12474366061771];

% reduce number of iterations for testing purposes
iters = 100000;

cov_rw = [0.000676409167258427,-2.23338600978907e-07,0.000446523169356018,-0.00217383399843512,-0.00140842407121212;-2.23338600978907e-07,8.42843550109126e-11,-1.43589642115548e-07,3.22813798987884e-07,4.63121072766443e-07;0.000446523169356018,-1.43589642115548e-07,0.00710728108138167,-0.0231838048874914,-0.00173384121992989;-0.00217383399843512,3.22813798987884e-07,-0.0231838048874914,0.583962485086875,-0.00735450516306901;-0.00140842407121212,4.63121072766443e-07,-0.00173384121992989,-0.00735450516306901,0.0161676520940240];

[theta, loglikes] = pmcmc_EnKF_ricker_rqmc(y,theta_init,iters,N,cov_rw);




% bootstrap
load('data_nutria.mat');
y = log(y);

N = 50000;
theta_init = [0.0517263338534942	-1.82433230479132e-05	-2.48322859630890	-3.12811329515897	6.12474366061771];

% reduce number of iterations for testing purposes
iters = 100000;

cov_rw = [0.000676409167258427,-2.23338600978907e-07,0.000446523169356018,-0.00217383399843512,-0.00140842407121212;-2.23338600978907e-07,8.42843550109126e-11,-1.43589642115548e-07,3.22813798987884e-07,4.63121072766443e-07;0.000446523169356018,-1.43589642115548e-07,0.00710728108138167,-0.0231838048874914,-0.00173384121992989;-0.00217383399843512,3.22813798987884e-07,-0.0231838048874914,0.583962485086875,-0.00735450516306901;-0.00140842407121212,4.63121072766443e-07,-0.00173384121992989,-0.00735450516306901,0.0161676520940240];

[theta, loglikes] = pmcmc_ricker(y,theta_init,iters,N,cov_rw);




%% flex ricker model

% EnKF
load('data_nutria.mat');
y = log(y);

N = 250;
theta_init = [0.0394748802097891,4.16169296537148e-05,-1.70949962209817e-08,-2.25315898483846,-4.83308680993441,6.52910983145511];

% reduce number of iterations for testing purposes
iters = 100000;

cov_rw = [0.00176036821797074,-1.34437695602250e-06,2.23571719854474e-10,0.000328383707830645,0.00103649079242708,-0.00155559787066688;-1.34437695602250e-06,1.44321136401742e-09,-2.88143872239094e-13,2.96845548935926e-07,-3.27331770495720e-06,1.29427902249147e-06;2.23571719854474e-10,-2.88143872239094e-13,6.27702495501014e-17,-1.24635342793264e-10,1.02371596439161e-09,-2.75720887575297e-10;0.000328383707830645,2.96845548935926e-07,-1.24635342793264e-10,0.0131457067894061,-0.0330807782030049,0.00308204169430810;0.00103649079242708,-3.27331770495720e-06,1.02371596439161e-09,-0.0330807782030049,0.262400488316900,-0.0345367192691154;-0.00155559787066688,1.29427902249147e-06,-2.75720887575297e-10,0.00308204169430810,-0.0345367192691154,0.0145295629472399];

[theta, loglikes] = pmcmc_EnKF_flex_ricker(y,theta_init,iters,N,cov_rw);



% EnKF - 1000 particles
load('data_nutria.mat');
y = log(y);

N = 1000;
theta_init = [0.0394748802097891,4.16169296537148e-05,-1.70949962209817e-08,-2.25315898483846,-4.83308680993441,6.52910983145511];

% reduce number of iterations for testing purposes
iters = 100000;

cov_rw = [0.00176036821797074,-1.34437695602250e-06,2.23571719854474e-10,0.000328383707830645,0.00103649079242708,-0.00155559787066688;-1.34437695602250e-06,1.44321136401742e-09,-2.88143872239094e-13,2.96845548935926e-07,-3.27331770495720e-06,1.29427902249147e-06;2.23571719854474e-10,-2.88143872239094e-13,6.27702495501014e-17,-1.24635342793264e-10,1.02371596439161e-09,-2.75720887575297e-10;0.000328383707830645,2.96845548935926e-07,-1.24635342793264e-10,0.0131457067894061,-0.0330807782030049,0.00308204169430810;0.00103649079242708,-3.27331770495720e-06,1.02371596439161e-09,-0.0330807782030049,0.262400488316900,-0.0345367192691154;-0.00155559787066688,1.29427902249147e-06,-2.75720887575297e-10,0.00308204169430810,-0.0345367192691154,0.0145295629472399];

[theta, loglikes] = pmcmc_EnKF_flex_ricker(y,theta_init,iters,N,cov_rw);



% EnKF - correlated
load('data_nutria.mat');
y = log(y);

N = 25;
theta_init = [0.0394748802097891,4.16169296537148e-05,-1.70949962209817e-08,-2.25315898483846,-4.83308680993441,6.52910983145511];

% reduce number of iterations for testing purposes
iters = 100000;

cov_rw = [0.00176036821797074,-1.34437695602250e-06,2.23571719854474e-10,0.000328383707830645,0.00103649079242708,-0.00155559787066688;-1.34437695602250e-06,1.44321136401742e-09,-2.88143872239094e-13,2.96845548935926e-07,-3.27331770495720e-06,1.29427902249147e-06;2.23571719854474e-10,-2.88143872239094e-13,6.27702495501014e-17,-1.24635342793264e-10,1.02371596439161e-09,-2.75720887575297e-10;0.000328383707830645,2.96845548935926e-07,-1.24635342793264e-10,0.0131457067894061,-0.0330807782030049,0.00308204169430810;0.00103649079242708,-3.27331770495720e-06,1.02371596439161e-09,-0.0330807782030049,0.262400488316900,-0.0345367192691154;-0.00155559787066688,1.29427902249147e-06,-2.75720887575297e-10,0.00308204169430810,-0.0345367192691154,0.0145295629472399];
sigma_corr = 0.1;

[theta, loglikes] = pmcmc_EnKF_flex_ricker_correlated(y,theta_init,iters,N,cov_rw,sigma_corr);




% EnKF - correlated - unbiased
load('data_nutria.mat');
y = log(y);

N = 25;
theta_init = [0.0394748802097891,4.16169296537148e-05,-1.70949962209817e-08,-2.25315898483846,-4.83308680993441,6.52910983145511];

% reduce number of iterations for testing purposes
iters = 100000;

cov_rw = [0.00176036821797074,-1.34437695602250e-06,2.23571719854474e-10,0.000328383707830645,0.00103649079242708,-0.00155559787066688;-1.34437695602250e-06,1.44321136401742e-09,-2.88143872239094e-13,2.96845548935926e-07,-3.27331770495720e-06,1.29427902249147e-06;2.23571719854474e-10,-2.88143872239094e-13,6.27702495501014e-17,-1.24635342793264e-10,1.02371596439161e-09,-2.75720887575297e-10;0.000328383707830645,2.96845548935926e-07,-1.24635342793264e-10,0.0131457067894061,-0.0330807782030049,0.00308204169430810;0.00103649079242708,-3.27331770495720e-06,1.02371596439161e-09,-0.0330807782030049,0.262400488316900,-0.0345367192691154;-0.00155559787066688,1.29427902249147e-06,-2.75720887575297e-10,0.00308204169430810,-0.0345367192691154,0.0145295629472399];
sigma_corr = 0.1;

[theta, loglikes] = pmcmc_EnKF_flex_ricker_correlated_unbiased(y,theta_init,iters,N,cov_rw,sigma_corr);


% EnKF - rqmc
load('data_nutria.mat');
y = log(y);

N = 50;
theta_init = [0.0394748802097891,4.16169296537148e-05,-1.70949962209817e-08,-2.25315898483846,-4.83308680993441,6.52910983145511];

% reduce number of iterations for testing purposes
iters = 100000;

cov_rw = [0.00176036821797074,-1.34437695602250e-06,2.23571719854474e-10,0.000328383707830645,0.00103649079242708,-0.00155559787066688;-1.34437695602250e-06,1.44321136401742e-09,-2.88143872239094e-13,2.96845548935926e-07,-3.27331770495720e-06,1.29427902249147e-06;2.23571719854474e-10,-2.88143872239094e-13,6.27702495501014e-17,-1.24635342793264e-10,1.02371596439161e-09,-2.75720887575297e-10;0.000328383707830645,2.96845548935926e-07,-1.24635342793264e-10,0.0131457067894061,-0.0330807782030049,0.00308204169430810;0.00103649079242708,-3.27331770495720e-06,1.02371596439161e-09,-0.0330807782030049,0.262400488316900,-0.0345367192691154;-0.00155559787066688,1.29427902249147e-06,-2.75720887575297e-10,0.00308204169430810,-0.0345367192691154,0.0145295629472399];

[theta, loglikes] = pmcmc_EnKF_flex_ricker_rqmc(y,theta_init,iters,N,cov_rw);




% bootstrap
load('data_nutria.mat');
y = log(y);

N = 50000;
theta_init = [0.0394748802097891,4.16169296537148e-05,-1.70949962209817e-08,-2.25315898483846,-4.83308680993441,6.52910983145511];

% reduce number of iterations for testing purposes
iters = 100000;

cov_rw = [0.00176036821797074,-1.34437695602250e-06,2.23571719854474e-10,0.000328383707830645,0.00103649079242708,-0.00155559787066688;-1.34437695602250e-06,1.44321136401742e-09,-2.88143872239094e-13,2.96845548935926e-07,-3.27331770495720e-06,1.29427902249147e-06;2.23571719854474e-10,-2.88143872239094e-13,6.27702495501014e-17,-1.24635342793264e-10,1.02371596439161e-09,-2.75720887575297e-10;0.000328383707830645,2.96845548935926e-07,-1.24635342793264e-10,0.0131457067894061,-0.0330807782030049,0.00308204169430810;0.00103649079242708,-3.27331770495720e-06,1.02371596439161e-09,-0.0330807782030049,0.262400488316900,-0.0345367192691154;-0.00155559787066688,1.29427902249147e-06,-2.75720887575297e-10,0.00308204169430810,-0.0345367192691154,0.0145295629472399];

[theta, loglikes] = pmcmc_flex_ricker(y,theta_init,iters,N,cov_rw);





%% fit theta logistic model



% EnKF 
load('data_nutria.mat');
y = log(y);

N = 250;
theta_init = [ -0.4138    0.8226   -0.0799   -2.3016   -3.6457    6.4478];

% reduce number of iterations for testing purposes
iters = 100000;

cov_rw = 0.5*[0.0262   -0.0127   -0.0158    0.0030    0.0095   -0.0150;...
   -0.0127    0.0598   -0.0043   -0.0016   -0.0024   -0.0089;...
   -0.0158   -0.0043    0.0145   -0.0010   -0.0062    0.0107;...
    0.0030   -0.0016   -0.0010    0.0082   -0.0024   -0.0026;...
    0.0095   -0.0024   -0.0062   -0.0024    0.0498    0.0009;...
   -0.0150   -0.0089    0.0107   -0.0026    0.0009    0.0300];

[theta, loglikes] = pmcmc_EnKF_theta_logistic(y,theta_init,iters,N,cov_rw);





% EnKF -  N1000
load('data_nutria.mat');
y = log(y);

N = 1000;
theta_init = [ -0.4138    0.8226   -0.0799   -2.3016   -3.6457    6.4478];

% reduce number of iterations for testing purposes
iters = 100000;

cov_rw = 0.5*[0.0262   -0.0127   -0.0158    0.0030    0.0095   -0.0150;...
   -0.0127    0.0598   -0.0043   -0.0016   -0.0024   -0.0089;...
   -0.0158   -0.0043    0.0145   -0.0010   -0.0062    0.0107;...
    0.0030   -0.0016   -0.0010    0.0082   -0.0024   -0.0026;...
    0.0095   -0.0024   -0.0062   -0.0024    0.0498    0.0009;...
   -0.0150   -0.0089    0.0107   -0.0026    0.0009    0.0300];

[theta, loglikes] = pmcmc_EnKF_theta_logistic(y,theta_init,iters,N,cov_rw);





% EnKF - correlated
load('data_nutria.mat');
y = log(y);

N = 25;
theta_init = [ -0.4138    0.8226   -0.0799   -2.3016   -3.6457    6.4478];

% reduce number of iterations for testing purposes
iters = 100000;

cov_rw = 0.5*[0.0262   -0.0127   -0.0158    0.0030    0.0095   -0.0150;...
   -0.0127    0.0598   -0.0043   -0.0016   -0.0024   -0.0089;...
   -0.0158   -0.0043    0.0145   -0.0010   -0.0062    0.0107;...
    0.0030   -0.0016   -0.0010    0.0082   -0.0024   -0.0026;...
    0.0095   -0.0024   -0.0062   -0.0024    0.0498    0.0009;...
   -0.0150   -0.0089    0.0107   -0.0026    0.0009    0.0300];
sigma_corr = 0.1;

[theta, loglikes] = pmcmc_EnKF_theta_logistic_correlated(y,theta_init,iters,N,cov_rw,sigma_corr);




% EnKF - correlated - unbiased
load('data_nutria.mat');
y = log(y);

N = 25;
theta_init = [ -0.4138    0.8226   -0.0799   -2.3016   -3.6457    6.4478];

% reduce number of iterations for testing purposes
iters = 100000;

cov_rw = 0.5*[0.0262   -0.0127   -0.0158    0.0030    0.0095   -0.0150;...
   -0.0127    0.0598   -0.0043   -0.0016   -0.0024   -0.0089;...
   -0.0158   -0.0043    0.0145   -0.0010   -0.0062    0.0107;...
    0.0030   -0.0016   -0.0010    0.0082   -0.0024   -0.0026;...
    0.0095   -0.0024   -0.0062   -0.0024    0.0498    0.0009;...
   -0.0150   -0.0089    0.0107   -0.0026    0.0009    0.0300];
sigma_corr = 0.1;

[theta, loglikes] = pmcmc_EnKF_theta_logistic_correlated_unbiased(y,theta_init,iters,N,cov_rw,sigma_corr);



% EnKF - rqmc
load('data_nutria.mat');
y = log(y);

N = 50;
theta_init = [ -0.4138    0.8226   -0.0799   -2.3016   -3.6457    6.4478];

% reduce number of iterations for testing purposes
iters = 100000;

cov_rw = 0.5*[0.0262   -0.0127   -0.0158    0.0030    0.0095   -0.0150;...
   -0.0127    0.0598   -0.0043   -0.0016   -0.0024   -0.0089;...
   -0.0158   -0.0043    0.0145   -0.0010   -0.0062    0.0107;...
    0.0030   -0.0016   -0.0010    0.0082   -0.0024   -0.0026;...
    0.0095   -0.0024   -0.0062   -0.0024    0.0498    0.0009;...
   -0.0150   -0.0089    0.0107   -0.0026    0.0009    0.0300];

[theta, loglikes] = pmcmc_EnKF_theta_logistic_rqmc(y,theta_init,iters,N,cov_rw);


% bootstrap

load('data_nutria.mat');
y = log(y);

N = 50000;
theta_init = [ -0.4138    0.8226   -0.0799   -2.3016   -3.6457    6.4478];

% reduce number of iterations for testing purposes
iters = 100000;

cov_rw = 0.5*[0.0262   -0.0127   -0.0158    0.0030    0.0095   -0.0150;...
   -0.0127    0.0598   -0.0043   -0.0016   -0.0024   -0.0089;...
   -0.0158   -0.0043    0.0145   -0.0010   -0.0062    0.0107;...
    0.0030   -0.0016   -0.0010    0.0082   -0.0024   -0.0026;...
    0.0095   -0.0024   -0.0062   -0.0024    0.0498    0.0009;...
   -0.0150   -0.0089    0.0107   -0.0026    0.0009    0.0300];

tic;
[theta, loglikes] = pmcmc_theta_logistic(y,theta_init,iters,N,cov_rw);
finaltime = toc;
save('results_thetalog_bootstrap.mat','theta','loglikes','finaltime');



%% mate limited model 


% EnKF 
load('data_nutria.mat');
y = log(y);

N = 200;
theta_init = [0.0814624097716059,-2.87590631792542e-05,-11.5045241267601,-2.22895920471985,-3.89726744161814,6.26651295268381];

% reduce number of iterations for testing purposes
iters = 100000;

cov_rw = [0.000869469572301773,-2.89507834839061e-07,-0.00174497302199573,-0.000190803227756876,0.000674937294825042,-0.000756943033098822;-2.89507834839061e-07,1.11177122707311e-10,4.47464788611504e-07,4.42486848482465e-08,-2.16512810566944e-07,2.51966044478066e-07;-0.00174497302199573,4.47464788611504e-07,0.861066455641807,-0.0227043400195553,0.190386898192981,-0.0414361740930808;-0.000190803227756876,4.42486848482465e-08,-0.0227043400195553,0.00907275944996476,-0.0190513725254902,0.00106638306194006;0.000674937294825042,-2.16512810566944e-07,0.190386898192981,-0.0190513725254902,0.170389547313515,-0.0112604574866157;-0.000756943033098822,2.51966044478066e-07,-0.0414361740930808,0.00106638306194006,-0.0112604574866157,0.0172502008683733];

[theta, loglikes] = pmcmc_EnKF_mate_limited(y,theta_init,iters,N,cov_rw);




% EnKF - N1000
load('data_nutria.mat');
y = log(y);

N = 1000;
theta_init = [0.0814624097716059,-2.87590631792542e-05,-11.5045241267601,-2.22895920471985,-3.89726744161814,6.26651295268381];

% reduce number of iterations for testing purposes
iters = 100000;

cov_rw = [0.000869469572301773,-2.89507834839061e-07,-0.00174497302199573,-0.000190803227756876,0.000674937294825042,-0.000756943033098822;-2.89507834839061e-07,1.11177122707311e-10,4.47464788611504e-07,4.42486848482465e-08,-2.16512810566944e-07,2.51966044478066e-07;-0.00174497302199573,4.47464788611504e-07,0.861066455641807,-0.0227043400195553,0.190386898192981,-0.0414361740930808;-0.000190803227756876,4.42486848482465e-08,-0.0227043400195553,0.00907275944996476,-0.0190513725254902,0.00106638306194006;0.000674937294825042,-2.16512810566944e-07,0.190386898192981,-0.0190513725254902,0.170389547313515,-0.0112604574866157;-0.000756943033098822,2.51966044478066e-07,-0.0414361740930808,0.00106638306194006,-0.0112604574866157,0.0172502008683733];

[theta, loglikes] = pmcmc_EnKF_mate_limited(y,theta_init,iters,N,cov_rw);





% EnKF - correlated
load('data_nutria.mat');
y = log(y);

N = 25;
theta_init = [0.0814624097716059,-2.87590631792542e-05,-11.5045241267601,-2.22895920471985,-3.89726744161814,6.26651295268381];

% reduce number of iterations for testing purposes
iters = 100000;

cov_rw = [0.000869469572301773,-2.89507834839061e-07,-0.00174497302199573,-0.000190803227756876,0.000674937294825042,-0.000756943033098822;-2.89507834839061e-07,1.11177122707311e-10,4.47464788611504e-07,4.42486848482465e-08,-2.16512810566944e-07,2.51966044478066e-07;-0.00174497302199573,4.47464788611504e-07,0.861066455641807,-0.0227043400195553,0.190386898192981,-0.0414361740930808;-0.000190803227756876,4.42486848482465e-08,-0.0227043400195553,0.00907275944996476,-0.0190513725254902,0.00106638306194006;0.000674937294825042,-2.16512810566944e-07,0.190386898192981,-0.0190513725254902,0.170389547313515,-0.0112604574866157;-0.000756943033098822,2.51966044478066e-07,-0.0414361740930808,0.00106638306194006,-0.0112604574866157,0.0172502008683733];
sigma_corr = 0.1;

[theta, loglikes] = pmcmc_EnKF_mate_limited_correlated(y,theta_init,iters,N,cov_rw,sigma_corr);




% EnKF - correlated - unbiased
load('data_nutria.mat');
y = log(y);

N = 25;
theta_init = [0.0814624097716059,-2.87590631792542e-05,-11.5045241267601,-2.22895920471985,-3.89726744161814,6.26651295268381];

% reduce number of iterations for testing purposes
iters = 100000;

cov_rw = [0.000869469572301773,-2.89507834839061e-07,-0.00174497302199573,-0.000190803227756876,0.000674937294825042,-0.000756943033098822;-2.89507834839061e-07,1.11177122707311e-10,4.47464788611504e-07,4.42486848482465e-08,-2.16512810566944e-07,2.51966044478066e-07;-0.00174497302199573,4.47464788611504e-07,0.861066455641807,-0.0227043400195553,0.190386898192981,-0.0414361740930808;-0.000190803227756876,4.42486848482465e-08,-0.0227043400195553,0.00907275944996476,-0.0190513725254902,0.00106638306194006;0.000674937294825042,-2.16512810566944e-07,0.190386898192981,-0.0190513725254902,0.170389547313515,-0.0112604574866157;-0.000756943033098822,2.51966044478066e-07,-0.0414361740930808,0.00106638306194006,-0.0112604574866157,0.0172502008683733];
sigma_corr = 0.1;

[theta, loglikes] = pmcmc_EnKF_mate_limited_correlated_unbiased(y,theta_init,iters,N,cov_rw,sigma_corr);





% EnKF - rqmc
load('data_nutria.mat');
y = log(y);

N = 50;
theta_init = [0.0814624097716059,-2.87590631792542e-05,-11.5045241267601,-2.22895920471985,-3.89726744161814,6.26651295268381];

% reduce number of iterations for testing purposes
iters = 100000;

cov_rw = [0.000869469572301773,-2.89507834839061e-07,-0.00174497302199573,-0.000190803227756876,0.000674937294825042,-0.000756943033098822;-2.89507834839061e-07,1.11177122707311e-10,4.47464788611504e-07,4.42486848482465e-08,-2.16512810566944e-07,2.51966044478066e-07;-0.00174497302199573,4.47464788611504e-07,0.861066455641807,-0.0227043400195553,0.190386898192981,-0.0414361740930808;-0.000190803227756876,4.42486848482465e-08,-0.0227043400195553,0.00907275944996476,-0.0190513725254902,0.00106638306194006;0.000674937294825042,-2.16512810566944e-07,0.190386898192981,-0.0190513725254902,0.170389547313515,-0.0112604574866157;-0.000756943033098822,2.51966044478066e-07,-0.0414361740930808,0.00106638306194006,-0.0112604574866157,0.0172502008683733];

[theta, loglikes] = pmcmc_EnKF_mate_limited_rqmc(y,theta_init,iters,N,cov_rw);


% bootstrap
load('data_nutria.mat');
y = log(y);

N = 50000;
theta_init = [0.0814624097716059,-2.87590631792542e-05,-11.5045241267601,-2.22895920471985,-3.89726744161814,6.26651295268381];

% reduce number of iterations for testing purposes
iters = 100000;

cov_rw = [0.000869469572301773,-2.89507834839061e-07,-0.00174497302199573,-0.000190803227756876,0.000674937294825042,-0.000756943033098822;-2.89507834839061e-07,1.11177122707311e-10,4.47464788611504e-07,4.42486848482465e-08,-2.16512810566944e-07,2.51966044478066e-07;-0.00174497302199573,4.47464788611504e-07,0.861066455641807,-0.0227043400195553,0.190386898192981,-0.0414361740930808;-0.000190803227756876,4.42486848482465e-08,-0.0227043400195553,0.00907275944996476,-0.0190513725254902,0.00106638306194006;0.000674937294825042,-2.16512810566944e-07,0.190386898192981,-0.0190513725254902,0.170389547313515,-0.0112604574866157;-0.000756943033098822,2.51966044478066e-07,-0.0414361740930808,0.00106638306194006,-0.0112604574866157,0.0172502008683733];

[theta, loglikes] = pmcmc_mate_limited(y,theta_init,iters,N,cov_rw);




